primary_q = [
	"Count total no. of figures in the below image.",
	"Count total no. of figures in the below image.",
	"Which horse is different?",
	"Which horse is different?",
	"Which one is different?",
	"Which one is different?",
	"Which colors are the same ?",
	"Which colors are the same ?",
	"How many squares are there ?",
	"How many squares are there ?",
	"Which one is different",
	"Which one is different",
	"How many triangles are present in the below figure ?",
	"How many triangles are present in the below figure ?",
	"Which of the below figures is different?",
	"Which of the below figures is different?",
	"Count the number of differences in the below images.",
	"Count the number of differences in the below images.",
	"How many rectangles are there in the figure?",
	"How many rectangles are there in the figure?",
	"Which one is different",
	"Which one is different",
	"Which one is different",
	"Which one is different",
	"Which one is different",
	"Which one is different",
	"Count no. of difference for below two images",
	"Count no. of difference for below two images",
	"Count no. of difference for below two images",
	"Count no. of difference for below two images",
	"Count no. of difference for below two images",
	"Count no. of difference for below two images",
	"How many differences are there between the above two images?",
	"How many differences are there between the above two images?",
	"Choose a figure which is different from the rest.",
	"Choose a figure which is different from the rest.",
	"Choose a figure which is different from the rest.",
	"Choose a figure which is different from the rest.",
	"How many differences are there between the above two images?",
	"How many differences are there between the above two images?",
	"Choose the correct spelling",
	"Choose the correct spelling",
	"Select the word with correct spelling",
	"Select the word with correct spelling",
	"Which is the top view?",
	"Which is the top view?",
	"Can you find the the mistake?",
	"Can you find the the mistake?",
	"Select the image different from the rest",
	"Select the image different from the rest",
	"Find the missing number.",
	"Find the missing number.",
	"Which path takes you out of the maze?",
	"Which path takes you out of the maze?",
	"How many colors can you see?",
	"How many colors can you see?",
	"Which square looks different?",
	"Which square looks different?",
	"How many 9s can you see in the above picture?",
	"How many 9s can you see in the above picture?",
];

primary_q_options = [
	["5", "7", "9", "8"],
	["5", "7", "9", "8"],
	["1", "2", "3", "All are same"],
	["1", "2", "3", "All are same"],
	["1", "2", "3", "All are same"],
	["1", "2", "3", "All are same"],
	["2 and 3", "1 and 2", "3 and 4", "None of the options"],
	["2 and 3", "1 and 2", "3 and 4", "None of the options"],
	["30", "35", "40", "45"],
	["30", "35", "40", "45"],
	["P", "Q", "R", "S"],
	["P", "Q", "R", "S"],
	["20", "24", "21", "23"],
	["20", "24", "21", "23"],
	["A", "B", "C", "D"],
	["A", "B", "C", "D"],
	["15", "5", "10", "20"],
	["15", "5", "10", "20"],
	["8", "9", "10", "7"],
	["8", "9", "10", "7"],
	["A", "B", "C", "D"],
	["A", "B", "C", "D"],
	["A", "B", "C", "D"],
	["A", "B", "C", "D"],
	["A", "B", "C", "D"],
	["A", "B", "C", "D"],
	["10", "11", "12", "14"],
	["10", "11", "12", "14"],
	["3", "5", "7", "9"],
	["3", "5", "7", "9"],
	["10", "11", "9", "5"],
	["10", "11", "9", "5"],
	["7", "9", "6", "13"],
	["7", "9", "6", "13"],
	["1", "3", "4", "5"],
	["1", "3", "4", "5"],
	["1", "2", "3", "5"],
	["1", "2", "3", "5"],
	["13", "10", "9", "11"],
	["13", "10", "9", "11"],
	["C", "A", "D", "B"],
	["C", "A", "D", "B"],
	["D", "C", "A", "B"],
	["D", "C", "A", "B"],
	["C", "D", "B", "A"],
	["C", "D", "B", "A"],
	["2,4,8", "5,9", "1,3,5,7", "3,7"],
	["2,4,8", "5,9", "1,3,5,7", "3,7"],
	["A", "B", "C", "None"],
	["A", "B", "C", "None"],
	["22", "13", "31", "24"],
	["22", "13", "31", "24"],
	["C", "A", "B", "None"],
	["C", "A", "B", "None"],
	["5", "7", "4", "6"],
	["5", "7", "4", "6"],
	["B", "D", "A", "C"],
	["B", "D", "A", "C"],
	["8", "7", "11", "9"],
	["8", "7", "11", "9"],
];

primary_q_ans = [
	"B",
	"B",
	"D",
	"D",
	"B",
	"B",
	"D",
	"D",
	"B",
	"B",
	"S",
	"S",
	"C",
	"C",
	"C",
	"C",
	"C",
	"C",
	"B",
	"B",
	"A",
	"A",
	"D",
	"D",
	"C",
	"C",
	"C",
	"C",
	"B",
	"B",
	"A",
	"A",
	"B",
	"B",
	"D",
	"D",
	"A",
	"A",
	"C",
	"C",
	"C",
	"C",
	"C",
	"C",
	"C",
	"C",
	"B",
	"B",
	"D",
	"D",
	"A",
	"A",
	"C",
	"C",
	"A",
	"A",
	"A",
	"A",
	"D",
	"D",
]; // hard

primary_q_images = [
	"1.png",
	"1.png",
	"2.png",
	"2.png",
	"3.png",
	"3.png",
	"4.png",
	"4.png",
	"5.png",
	"5.png",
	"6.png",
	"6.png",
	"7.png",
	"7.png",
	"8.png",
	"8.png",
	"9.png",
	"9.png",
	"10.png",
	"10.png",
	"11.png",
	"11.png",
	"12.png",
	"12.png",
	"13.png",
	"13.png",
	"14.png",
	"14.png",
	"15.png",
	"15.png",
	"16.png",
	"16.png",
	"image17.png",
	"image17.png",
	"image18.png",
	"image18.png",
	"image19.png",
	"image19.png",
	"image20.png",
	"image20.png",
	"image21.png",
	"image21.png",
	"image22.png",
	"image22.png",
	"image23.png",
	"image23.png",
	"image24.png",
	"image24.png",
	"image25.png",
	"image25.png",
	"image26.png",
	"image26.png",
	"image27.png",
	"image27.png",
	"image29.png",
	"image29.png",
	"image30.png",
	"image30.png",
	"image.png",
	"image.png",
];

primary_score = 0;

primary_q_sel = [];

primary_q_dur = [];

curr_prim_q_no = 1;

sec_q_attempt_for_prim = [];

sec_q = [
	"Choose the box that comes next in the sequence",
	"Choose the box that comes next in the sequence ",
	"Choose the box that comes next in the sequence",
	"Choose the box that comes next in the sequence",
	"Find the word Red",
	"Find the word Red",
	"Find the word Red",
	"Find the word Red",
	"Find the word Red",
	"Find the word Red",
]; // hard

sec_q_ans = ["C", "D", "B", "A", "C", "B", "B", "C", "A", "A"]; // hard

sec_q_images = [
	"Q 1.jpg",
	"Q 2.jpg",
	"Q 3.jpg",
	"Q 4.jpg",
	"Q 5.jpg",
	"Q 6.jpg",
	"Q 7.jpg",
	"Q 8.jpg",
	"Q 9.jpg",
	"Q 10.jpg",
];

cur_sec_q_no = 1;

no_of_sec_correct = 0;

// Timer for primary
var prevTime = new Date();
let countdown;
function resetTimer() {
	let startDate = new Date();
	let endDate = new Date();
	endDate.setSeconds(endDate.getSeconds() + 5);
	const months = [
		"January",
		"February",
		"March",
		"April",
		"May",
		"June",
		"July",
		"August",
		"September",
		"October",
		"November",
		"December",
	];
	const weekdays = [
		"Sunday",
		"Monday",
		"Tuesday",
		"Wednesday",
		"Thursday",
		"Friday",
		"Saturday",
	];

	let ed = new Date(endDate);

	const futureTime = ed.getTime();

	function getRemainingTime() {
		const today = new Date().getTime();

		const t = futureTime - today;
		const oneHour = 60 * 60 * 1000;
		const oneMinute = 60 * 1000;
		let hours = Math.floor(t / oneHour);
		let minutes = Math.floor((t % oneHour) / oneMinute);
		let seconds = Math.floor((t % oneMinute) / 1000);

		// Changing the values in DOM
		const hrs = $(".hours");
		const mins = $(".mins");
		const secs = $(".secs");
		const items = [hrs, mins, secs];
		const values = [hours, minutes, seconds];
		function format(item) {
			if (item < 10) {
				return (item = `0${item}`);
			}
			return item;
		}
		items.forEach(function (item, index) {
			item.html(format(values[index]));
		});

		if (t < 0) {
			updateDuration();
			primary_q_sel.push("N");
			if (curr_prim_q_no >= primary_q.length) {
				clearInterval(countdown);
				var dur = `<input type="text" name = "dur" value = "${primary_q_dur.toString()}">`;
				var sels = `<input type="text" name = "sel" value = "${primary_q_sel.toString()}">`;
				var p_score = `<input type="text" name = "p_score" value = "${primary_score}">`;
				$(".dummy-form").append(dur);
				$(".dummy-form").append(sels);
				$(".dummy-form").append(p_score);
				$(".dummy-form").submit();
				return;
			}
			nextQ();
			clearInterval(countdown);
			resetTimer();
		}
	}
	countdown = setInterval(getRemainingTime, 1000);

	getRemainingTime();
}

window.onload = function () {
	resetTimer();
	// nextQ();
	addToPrimaryCard(curr_prim_q_no - 1);
};

function addToPrimaryCard(i) {
	let primary_task = `<div class="card">
    <img class="p-task-img" src="/Images/primary_imgs/${primary_q_images[i]}" width="350" height="350">
        <div class="card-body">
            <div class = "qs"> ${primary_q[i]}</div>
            <input type="radio" name = "option" class="p_op_a option">${primary_q_options[i][0]}<br>
            <input type="radio" name = "option" class="p_op_b option">${primary_q_options[i][1]}<br>
            <input type="radio" name = "option" class="p_op_c option">${primary_q_options[i][2]}<br>
            <input type="radio" name = "option" class="p_op_d option">${primary_q_options[i][3]}<br>
        </div>
</div>`;
	if (i % 2 == 1)
		$("#primary-task").append(`<div>DO YOU WISH TO CHANGE YOUR ANSWER?</div>`);
	$("#primary-task").append(primary_task);
}

//Insert the next question into the html dom and update the variables
function nextQ() {
	$("#primary-task").empty();

	if (curr_prim_q_no == 1) {
		sec_q_attempt_for_prim.push(no_of_sec_correct);
	} else {
		sec_q_attempt_for_prim.push(
			no_of_sec_correct -
				sec_q_attempt_for_prim[sec_q_attempt_for_prim.length - 1]
		);
	}
	addToPrimaryCard(curr_prim_q_no);
	curr_prim_q_no += 1;
	clearInterval(countdown);
	resetTimer();
}

// When a checkbox is selected
function updateDuration() {
	var curTime = new Date();
	var duration = (curTime.getTime() - prevTime.getTime()) / 1000;
	primary_q_dur.push(duration);
	prevTime = curTime;
}

$("#primary-task").on("click", ".option", function () {
	if ($(".p_op_a").is(":checked") == true) {
		console.log("You selected A");
		primary_q_sel.push("A");
		if (primary_q_ans[curr_prim_q_no - 1] === "A") primary_score++;
		updateDuration();
		nextQ();
	} else if ($(".p_op_b").is(":checked") == true) {
		console.log("You selected B");
		primary_q_sel.push("B");
		if (primary_q_ans[curr_prim_q_no - 1] === "B") primary_score++;
		updateDuration();
		nextQ();
	} else if ($(".p_op_c").is(":checked") == true) {
		console.log("You selected C");
		primary_q_sel.push("C");
		if (primary_q_ans[curr_prim_q_no - 1] === "C") primary_score++;
		updateDuration();
		nextQ();
	} else if ($(".p_op_d").is(":checked") == true) {
		console.log("You selected D");
		primary_q_sel.push("D");
		if (primary_q_ans[curr_prim_q_no - 1] === "D") primary_score++;
		updateDuration();
		nextQ();
	}
});

// Pressing Space to move to the next question
document.body.onkeyup = function (e) {
	if (e.key == " " || e.code == "Space" || e.keyCode == 32) {
		$("#primary_task").empty();
		primary_q_sel.push("N");
		updateDuration();
		nextQ();
	} else if (e.keyCode == 80) {
		// alert("P was pressed");
	}
};

///////////////////////////////////////////
// Logic for secocondary questions
let countdownSec;
function resetTimerSec() {
	let endDate = new Date();
	endDate.setSeconds(endDate.getSeconds() + 10);
	const months = [
		"January",
		"February",
		"March",
		"April",
		"May",
		"June",
		"July",
		"August",
		"September",
		"October",
		"November",
		"December",
	];
	const weekdays = [
		"Sunday",
		"Monday",
		"Tuesday",
		"Wednesday",
		"Thursday",
		"Friday",
		"Saturday",
	];
	let ed = new Date(endDate);
	const futureTime = ed.getTime();
	function getRemainingTime() {
		const today = new Date().getTime();
		const t = futureTime - today;
		const oneHour = 60 * 60 * 1000;
		const oneMinute = 60 * 1000;
		let hours = Math.floor(t / oneHour);
		let minutes = Math.floor((t % oneHour) / oneMinute);
		let seconds = Math.floor((t % oneMinute) / 1000);

		// Changing the values in DOM
		const mins = $(".mins");
		const secs = $(".secs");
		const items = [hrs, mins, secs];
		const values = [hours, minutes, seconds];
		function format(item) {
			if (item < 10) return (item = `0${item}`);
			return item;
		}
		items.forEach(function (item, index) {
			item.html(format(values[index]));
		});

		if (t < 0) {
			if (curr_prim_q_no > primary_q.length) {
				clearInterval(countdown);
				return;
			}
			nextQ();
			clearInterval(countdown);
			resetTimer();
			// $(".quiz-form").submit();
		}
	}
	countdownSec = setInterval(getRemainingTime, 1000);

	getRemainingTime();
}
